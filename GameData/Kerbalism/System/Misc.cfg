// ============================================================================
// Stock panel module work correctly at arbitrary warp speed and EC capacity
// ============================================================================

@PART[*]:HAS[@MODULE[ModuleDeployableSolarPanel]]:FOR[Kerbalism]
{
  MODULE
  {
    name = WarpFixer
  }
}


// ============================================================================
// Use Monoprop as eva propellant, and set the initial amount to zero
// ============================================================================

@PART[kerbalEVA,kerbalEVAfemale]:FOR[Kerbalism]
{
  @MODULE[KerbalEVA]
  {
    @propellantResourceName = MonoPropellant
  }

  @RESOURCE[EVA?Propellant]
  {
    @name = MonoPropellant
    @amount = 0
    @maxAmount = 5
  }
}


// ============================================================================
// Replace readings with our own telemetry providers
// ============================================================================

@PART[sensorThermometer]:FOR[Kerbalism]
{
  !MODULE[ModuleEnviroSensor] {}

  MODULE
  {
    name = Sensor
    type = temperature
  }
}

@PART[sensorBarometer]:FOR[Kerbalism]
{
  !MODULE[ModuleEnviroSensor] {}

  MODULE
  {
    name = Sensor
    type = pressure
  }
}

@PART[sensorGravimeter]:FOR[Kerbalism]
{
  !MODULE[ModuleEnviroSensor] {}

  MODULE
  {
    name = Sensor
    type = gravioli
  }
}


// ============================================================================
// Probe hibernation removal is GO
// ============================================================================

@PART[*]:HAS[@MODULE[ModuleCommand]]:FOR[Kerbalism]
{
  @MODULE[ModuleCommand]
  {
    %hasHibernation = false
  }
}


// ============================================================================
// Set generic part tags
// ============================================================================

@PART[kerbalism-*]:FOR[zzzKerbalism] { %tags = _kerbalism }
@PART[kerbalism-greenhouse,kerbalism-container-inline-*,kerbalism-lifesupportmodule]:FOR[zzzKerbalism]
 { %tags = #$tags$ life support }


// ============================================================================
// Set part specific tags
// ============================================================================

@PART[kerbalism-activeshield]:AFTER[zzzKerbalism] { %tags = #$tags$ magnetic field radiation shield }
@PART[kerbalism-chemicalplant]:AFTER[zzzKerbalism] { %tags = #$tags$ external chemical plant electrolysis o2 oxygen h2 hydrogen h2o water sabatier haber liquidfuel nh3 ammonia waste incinerator compressor anthraquinone hydrazine mre soe sco }
@PART[kerbalism-lifesupportmodule]:AFTER[zzzKerbalism] { %tags = #$tags$ external eclss scrubber pressure control atmosphere wasteatmosphere o2 oxygen nitrogen co2 carbondioxide humidity h2o water recycler waste processor fuelcell fuel cell monoprop }
@PART[kerbalism-geigercounter]:AFTER[zzzKerbalism] { %tags = #$tags$ geiger counter science sensor }
@PART[kerbalism-gravityring]:AFTER[zzzKerbalism] { %tags = #$tags$ habitat crew gravity rotate comfort }
@PART[kerbalism-greenhouse]:AFTER[zzzKerbalism] { %tags = #$tags$ habitat crew greenhouse food crop hydroponic co2 carbondioxide waste atmosphere wasteatmosphere h2o water o2 oxygen }
@PART[kerbalism-container-inline-*]:AFTER[zzzKerbalism] { %tags = #$tags$ supply supplies food water waste wastewater container }
@PART[kerbalism-container-inline-0625]:AFTER[zzzKerbalism] { %tags = #$tags$ 625 0625 0.625 .625 }
@PART[kerbalism-container-inline-125]:AFTER[zzzKerbalism] { %tags = #$tags$ 125 1.25 }
@PART[kerbalism-container-inline-250]:AFTER[zzzKerbalism] { %tags = #$tags$ 250 2.5 2.50 }
@PART[kerbalism-container-inline-375]:AFTER[zzzKerbalism] { %tags = #$tags$ 375 3.75 }
@PART[kerbalism-*pump]:AFTER[zzzKerbalism] { %tags = #$tags$ harvest extract pump h2o water nitrogen nh3 ammonia }
@PART[kerbalism-container-radial-*]:AFTER[zzzKerbalism] { %tags = #$tags$ external radial tank pressurized o2 oxygen nitrogen h2 hydrogen nh3 ammonia co2 carbondioxide }
@PART[kerbalism-antenna]:AFTER[zzzKerbalism] { %tags = #$tags$ antenna }


// ============================================================================
// Avoid some harmless warning during part loading
// ============================================================================

@PART[kerbalism-container-*]:FINAL { !ContainerVolume = _ }


// ============================================================================
// Increase all crewable parts' EC because ECLSS uses EC constantly,
// you wanna survive in the Apollo LM, right?
// ============================================================================

@PART[*]:HAS[#CrewCapacity[>0],@RESOURCE[ElectricCharge]]:NEEDS[ProfileDefault]:AFTER[zzzKerbalism]
{
	@RESOURCE[ElectricCharge]
	{
		@amount *= 2.8
		@maxAmount *= 2.8
	}
}
