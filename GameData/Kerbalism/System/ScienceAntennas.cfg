// ============================================================================
// Antenna values that actually make sense...
// The idea is to be very restrictive here and increase data rates with
// tech upgrades.
// ============================================================================

// Catch-all patch
@PART[*]:NEEDS[FeatureScience]:FOR[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    // Setup all antennas based on their rating. This works for all antennas
    // rated >1Gm which should be all, except for the Communotron 8/16/16-S
    // which we'll handle below.
    // While this won't produce nice numbers, it will nerf all antennas,
    // because usually they'd be MASSIVELY OP for our science system.
    %packetSize = #$antennaPower$         // our bandwidth is based on power
    @packetSize /= 1000000                // convert to Gm
    @packetSize != 0.5                    // square root of Gm, that's our Kb/s
    %packetResourceCost = #$packetSize$   // base EC/min off packet size
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1
  }
}

// Communotron 8
@PART[kerbalism-antenna]:NEEDS[FeatureScience]:AFTER[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    %packetSize = 2               // <- Kb/s
    %packetResourceCost = 0.7     // <- EC/min
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1

    UPGRADES {
      UPGRADE {
        name__ = Improved-Signals
        techRequired__ = basicScience
        packetSize = 2.4
        @packetSize /= 1024
      }

      UPGRADE {
        name__ = Advanced-Encoding
        techRequired__ = electronics
        packetSize = 3.7
        @packetSize /= 1024
      }
    }
  }
}

// Communotron 16, Communotron 16-S
@PART[longAntenna,SurfAntenna]:NEEDS[FeatureScience]:AFTER[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    %packetSize = 3               // <- Kb/s
    %packetResourceCost = 1.2     // <- EC/min
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1

    UPGRADES {
      UPGRADE {
        name__ = Improved-Signals
        techRequired__ = basicScience
        packetSize = 3.4
        @packetSize /= 1024
      }

      UPGRADE {
        name__ = Advanced-Encoding
        techRequired__ = electronics
        packetSize = 6.0
        @packetSize /= 1024
      }
    }
  }
}

// HG-5
@PART[HighGainAntenna5]:NEEDS[FeatureScience]:AFTER[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    %packetSize = 4               // <- Kb/s
    %packetResourceCost = 5       // <- EC/min
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1

    UPGRADE {
      name__ = Advanced-Encoding
      techRequired__ = electronics
      packetSize = 7
      @packetSize /= 1024
    }
  }
}

// Communotron DTS-M1
@PART[mediumDishAntenna]:NEEDS[FeatureScience]:AFTER[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    %packetSize = 8               // <- Kb/s
    %packetResourceCost = 3.4     // <- EC/min
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1
  }
}

// RA-2
@PART[RelayAntenna5]:NEEDS[FeatureScience]:AFTER[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    %packetSize = 4.5             // <- Kb/s
    %packetResourceCost = 4       // <- EC/min
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1
  }
}

// Communotron HG-55
@PART[HighGainAntenna]:NEEDS[FeatureScience]:AFTER[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    %packetSize = 15              // <- Kb/s
    %packetResourceCost = 12      // <- EC/min
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1
  }
}

// RA-15
@PART[RelayAntenna50]:NEEDS[FeatureScience]:AFTER[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    %packetSize = 7.5             // <- Kb/s
    %packetResourceCost = 16      // <- EC/min
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1
  }
}

// Communotron 88-88
@PART[commDish]:NEEDS[FeatureScience]:AFTER[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    %packetSize = 24              // <- Kb/s
    %packetResourceCost = 24      // <- EC/min
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1
  }
}

// RA-100
@PART[RelayAntenna100]:NEEDS[FeatureScience]:AFTER[Kerbalism]
{
  @MODULE[ModuleDataTransmitter]
  {
    %packetSize = 12              // <- Kb/s
    %packetResourceCost = 30      // <- EC/min
    @packetSize /= 1024
    @packetResourceCost /= 60
    %packetInterval = 1
  }
}

// ============================================================================
// Antenna Upgrades
// ============================================================================

PARTUPGRADE:NEEDS[FeatureScience]
{
  name = Improved-Signals
  partIcon = longAntenna
  techRequired = basicScience
  entryCost = 1000
  title = Increase data rates
  manufacturer = KT&T
  description = Latest developments in radio and telecommunications allow for higher transmission rates
}

PARTUPGRADE:NEEDS[FeatureScience]
{
  name = Advanced-Encoding
  partIcon = HighGainAntenna5
  techRequired = electronics
  entryCost = 3500
  title = Signal Processor Boost
  manufacturer = KT&T
  description = Multiband transmission give a big boost in transmission rates
}
