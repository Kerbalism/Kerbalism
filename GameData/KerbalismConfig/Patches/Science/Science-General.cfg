// ============================================================================
// Replace the stock scanner module with our experiment that reproduces the feature
// Do it late (zzz) in case some MM patch is relying on that module being present (ScanSat?)
// ============================================================================
@PART[*]:HAS[@MODULE[ModuleOrbitalSurveyor]]:NEEDS[KerbalismScience]:FOR[zzzKerbalism]
{
  !MODULE[ModuleOrbitalSurveyor] {}

  MODULE
  {
    name = ModuleKsmExperiment
    moduleDefinition = kerbalism_ResourceScanner
    allow_shrouded = False
    use_animation_group = True
  }
}

//==============================================================================
// Geiger counter
//==============================================================================

EXPERIMENT_DEFINITION
{
	id = geigerCounter
	title = #KERBALISM_EXPERIMENT_Radiation_title

  KERBALISM_EXPERIMENT
	{
		DataSize = 0.5
		SciencePoints = 4

		MODULE_DEFINITION
		{
			name = geigerCounter
			Duration = 6m30s
			RequiredEC = 0.005
		}

		VirtualBiome = NoBiome
		VirtualBiome = InnerBelt
		VirtualBiome = OuterBelt
		VirtualBiome = Magnetosphere
    VirtualBiome = Storm
    VirtualBiome = Interstellar

    Situation = Surface@Biomes
    Situation = FlyingLow
    Situation = FlyingHigh
    Situation = Space@VirtualBiomes
	}

	RESULTS
	{
		default = #KERBALISM_EXPERIMENT_Radiation_default//Holy cow these results are amazing!.
		MohoSrfLanded = #KERBALISM_EXPERIMENT_Radiation_MohoSrfLanded//The Geiger counter agrees that Moho would be cooler with lava. The KSC has informed you that talking to the Geiger counter is strictly forbidden.
		EveSrfLanded = #KERBALISM_EXPERIMENT_Radiation_EveSrfLanded//It seems that high radiation levels are the one thing you don't have to worry about on the surface of Eve.
		GillySrfLanded = #KERBALISM_EXPERIMENT_Radiation_GillySrfLanded//You are having too much fun bouncing around to check the radiation levels.
		KerbinSrfLanded = #KERBALISM_EXPERIMENT_Radiation_KerbinSrfLanded//Radiation levels are quite literally nominal here on Kerbin. Something must be blocking the radiation.
		MunSrfLanded = #KERBALISM_EXPERIMENT_Radiation_MunSrfLanded//Radiation on the surface of the Mun is fairly high, any future habitation would require more shielding.
		MinmusSrfLanded = #KERBALISM_EXPERIMENT_Radiation_MinmusSrfLanded//Looking at the radiation levels, you regret tasting the surface of Minmus.
		DunaSrfLanded = #KERBALISM_EXPERIMENT_Radiation_DunaSrfLanded//These results are critical for the development of a Duna colony. Shame if something were to happen to them...
		IkeSrfLanded = #KERBALISM_EXPERIMENT_Radiation_IkeSrfLanded//The surface contains a trace amount of radioactive compounds, R&D believed these are elements created by interactions between solar wind and Duna's atmosphere.
		DresSrfLanded = #KERBALISM_EXPERIMENT_Radiation_DresSrfLanded//Cross referencing these results with surface samples, Dres seems to consist of a large amount of heavy, radioactive metals
		LaytheSrfLanded = #KERBALISM_EXPERIMENT_Radiation_LaytheSrfLanded//Laythe's atmosphere and active core protect its surface from Jool's intense radiation belt, but the background radiation is significantly higher than Kerbin's
		VallSrfLanded = #KERBALISM_EXPERIMENT_Radiation_VallSrfLanded//Vall is fortunate enough to not be located in Jool's radiation belt, but the radiation on the surface is still significant.
		TyloSrfLanded = #KERBALISM_EXPERIMENT_Radiation_TyloSrfLanded//The functioning magnetosphere Tylo possesses is enough to shield the planet from most of Jool's radiation, but its lack of atmosphere means a significant amount of radiation still reaches the surface
		BopSrfLanded = #KERBALISM_EXPERIMENT_Radiation_BopSrfLanded//KSC warns against trying to locate the intense source of radiation they spotted from orbit.
		PolSrfLanded = #KERBALISM_EXPERIMENT_Radiation_PolSrfLanded//It seems that Pol contains a large amount of radioactive Hydrogen and Helium isotopes, deposited by Jool over thousands of years.
		EelooSrfLanded = #KERBALISM_EXPERIMENT_Radiation_EelooSrfLanded//This far from Kerbol, much more interstellar radiation reaches the surface. This would be a great place for future study
		EveFlyingLow = #KERBALISM_EXPERIMENT_Radiation_EveFlyingLow//Eve's thick atmosphere and large magnetosphere prevents any radiation from reaching this altitude.
		KerbinFlyingLow = #KERBALISM_EXPERIMENT_Radiation_KerbinFlyingLow//The vibrations from your rocket make the dials unreadable, so you decide to make up the results.
		DunaFlyingLow = #KERBALISM_EXPERIMENT_Radiation_DunaFlyingLow//The atmosphere seems to block more radiation then originally predicted. This bodes well for future Duna missions.
		JoolFlyingLow = #KERBALISM_EXPERIMENT_Radiation_JoolFlyingLow//You go to check the Geiger counter, but it refuses to display a reading until you take it out of the atmosphere.
		LaytheFlyingLow = #KERBALISM_EXPERIMENT_Radiation_LaytheFlyingLow//The oceans below emit an unexpected amount of radiation.
		EveFlyingHigh = #KERBALISM_EXPERIMENT_Radiation_EveFlyingHigh//You are too busy trying not to burn up in the atmosphere to look at the Geiger counter.
		KerbinFlyingHigh = #KERBALISM_EXPERIMENT_Radiation_KerbinFlyingHigh//The atmosphere is absorbing most of the radiation, even up there.
		DunaFlyingHigh = #KERBALISM_EXPERIMENT_Radiation_DunaFlyingHigh//The atmosphere here is emitting large amounts of ionized particles.
		JoolFlyingHigh = #KERBALISM_EXPERIMENT_Radiation_JoolFlyingHigh//The KSC has insured that your third eye is completely normal.
		LaytheFlyingHigh = #KERBALISM_EXPERIMENT_Radiation_LaytheFlyingHigh//The radiation from Jool produces interesting by-products when it bombards Laythe's atmosphere
		SunInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_SunInSpaceLow//It's over 9000!!
		MohoInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_MohoInSpaceLow//R&D informs you that these results have contributed to a scientific breakthrough. You are too busy hugging the air conditioner to care.
		EveInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_EveInSpaceLow//Eve's atmosphere emits strange ions that throw off your readings.
		GillyInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_GillyInSpaceLow//The radiation levels here flux because of Gilly's eccentric orbit and Eve's magnetosphere.
		KerbinInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_KerbinInSpaceLow//The radiation environment up there is more complex than we throught. This should give R&D something new to study.
		MunInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_MunInSpaceLow//You notice a steady pulse of radiation as you pass over the dark side of the Mun. It's probably nothing.
		MinmusInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_MinmusInSpaceLow//The results indicate that Minmus has large amounts of radioactive compounds mixed within the icy crust.
		DunaInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_DunaInSpaceLow//The sun is stripping away Duna's fragile atmosphere, as Duna is emitting a stream of ionized particles.
		IkeInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_IkeInSpaceLow//Ike's close orbit and tidally locked state means that when you are over the side of Ike facing Duna the radiation levels drop immensely.
		DresInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_DresInSpaceLow//The Geiger counter has detected large amounts of radiation originating from Dres.
		JoolInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_JoolInSpaceLow//KSC has advised that you will not be allowed to return for fear that you will contaminate the rest of Kerbalkind
		LaytheInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_LaytheInSpaceLow//As you look down at the beautiful ocean below, you forget that you are slowly dying of radiation poisoning.
		VallInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_VallInSpaceLow//Amazingly, the radiation levels are at a reasonable level.
		TyloInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_TyloInSpaceLow//The subtle magnetosphere of Tylo acts as a generator, magnifying Jool's already intense radiation field.
		BopInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_BopInSpaceLow//Bop has an abnormally high amount of radiation that seems to be pin-pointed at 68 degrees north, 114 degrees east. Strange
		PolInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_PolInSpaceLow//The space around Pol is filled with radioactive ions that have been unfortunate enough to be caught by Jool's magnetosphere.
		EelooInSpaceLow = #KERBALISM_EXPERIMENT_Radiation_EelooInSpaceLow//R&D is keen to study what effects the large amount of interstellar radiation has done to the surface of Eeloo.
		SunInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_SunInSpaceHigh//The KSC informs you that they *may* have forgotten to add the shielding.
		MohoInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_MohoInSpaceHigh//The radiation from the sun has picked up dramatically over the course of your journey.
		EveInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_EveInSpaceHigh//You are not looking forward to traveling through Eve's radiation belt.
		GillyInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_GillyInSpaceHigh//You refuse to check the radiation levels unless the KSC stops making Potato puns.
		KerbinInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_KerbinInSpaceHigh//This place is dangerous.
		MunInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_MunInSpaceHigh//You crossed Kerbin's radiation belt, and did not die. You worry that this will spawn a bunch of crazy conspiracy theories.
		MinmusInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_MinmusInSpaceHigh//You pick up an abnormal amount of radiation, but can't figure out the origin.
		DunaInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_DunaInSpaceHigh//Duna doesnâ€™t seem to have a magnetosphere, so cosmic radiation will be a problem for future Duna missions.
		IkeInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_IkeInSpaceHigh//Unexpectedly, Ike appears to be magnetic enough to mess with the ion's striped from Duna's atmosphere.
		DresInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_DresInSpaceHigh//In the asteroid, nobody can hear you face palm when you realise that you forgot the Geiger counter.
		JoolInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_JoolInSpaceHigh//The radiation being emitted from Jool is a staggering amount, and you start to wish you were on the Duna exploration mission.
		LaytheInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_LaytheInSpaceHigh//Laythe is, incredibly, putting up a large resistance to the onslaught of Jool's radiation belt. God speed Laythe. God speed.
		VallInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_VallInSpaceHigh//Even though Vall isn't located in the main radiation belt, it is still viciously punished by Jool's radiation.
		TyloInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_TyloInSpaceHigh//The radiation from Jool forms an intense belt around Tylo, but luckily it doesnâ€™t look like much reaches the surface. But much is a relative term.
		BopInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_BopInSpaceHigh//Bop actually seems to be a source of intense radiation, but amongst Jool's radiation field, it doesnâ€™t appear significant.
		PolInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_PolInSpaceHigh//Pol is far enough away from Jool that it receives ionized isotopes sourced from Jool's magnetosphere and interplanetary gas.
		EelooInSpaceHigh = #KERBALISM_EXPERIMENT_Radiation_EelooInSpaceHigh//As Kerbol's influence weakens, interstellar radiation becomes much more pronounced. The secrets of the galaxy lay open to you.
	}
}

// =============================================================================
// DING
// =============================================================================

EXPERIMENT_DEFINITION:NEEDS[KerbalismScience]
{
	id = kerbalism_DING
	title = #kerbalism-experiment-ding-title

  KERBALISM_EXPERIMENT
	{
    Description = #kerbalism-experiment-ding-desc
		DataSize = 672862
		SciencePoints = 30

		MODULE_DEFINITION
		{
			Duration = 200d
			RequiredEC = 1.8
		}

    Situation = InSpaceHigh
    BodyNotAllowed = Suns
	}
}

// =============================================================================
// BEEP
// =============================================================================

EXPERIMENT_DEFINITION:NEEDS[KerbalismScience]
{
	id = kerbalism_BEEP
	title = #kerbalism-experiment-beep-title

  KERBALISM_EXPERIMENT
	{
    Description = #kerbalism-experiment-beep-desc
		DataSize = 4572
		SciencePoints = 33

		MODULE_DEFINITION
		{
			Duration = 260d
			RequiredEC = 1.03
		}

    Situation = InSpaceLow@Biomes
	}
}

// =============================================================================
// TICK
// =============================================================================

EXPERIMENT_DEFINITION:NEEDS[KerbalismScience]
{
	id = kerbalism_TICK
	title = #kerbalism-experiment-tick-title

  KERBALISM_EXPERIMENT
	{
    Description = #kerbalism-experiment-tick-desc
		DataSize = 204060
		SciencePoints = 160

		MODULE_DEFINITION
		{
			Duration = 2y
			RequiredEC = 0.48
		}

    Situation = InSpaceLow
    Situation = InSpaceHigh
    BodyAllowed = Suns
	}
}

// =============================================================================
// Resource Scanner
// =============================================================================

EXPERIMENT_DEFINITION:NEEDS[KerbalismScience]
{
	id = kerbalism_ResourceScanner
	title = #kerbalism-experiment-resourceScanner-title

	KERBALISM_EXPERIMENT
	{
    Description = #kerbalism-experiment-resourceScanner-desc
		DataSize = 2000
		SciencePoints = 8

		MODULE_DEFINITION
		{
			Duration = 20d
			RequiredEC = 0.5
      Requirements = OrbitMinInclination:80,OrbitMaxInclination:100,AltitudeBodyRadiusMin:3,AltitudeBodyRadiusMax:4
		}

  	UnlockResourceSurvey = true
  	Situation = BodyGlobal
  	BodyNotAllowed = Suns
	}
}
