// ============================================================================
// ISRU chemical plants
// ============================================================================

// kerbalism-chemicalplant phasing out after Kerbalism 3.4
@PART[kerbalism-chemicalplant]:FOR[Kerbalism]
{
  MODULE
  {
    name = ModuleB9PartSwitch
    switcherDescription = #kerbalism-part-chemicalProcess
    moduleID = chemicalProcess
    affectDragCubes = false
    affectFARVoxels = false
  }

  MODULE
  {
    name = ModuleKsmProcessController
    id = chemicalProcess
    capacity = 2
  }
}

@PART[MiniISRU]:FOR[Kerbalism]
{
  MODULE
  {
    name = ModuleB9PartSwitch
    switcherDescription = #kerbalism-part-chemicalProcess
    moduleID = chemicalProcess
    affectDragCubes = false
    affectFARVoxels = false
  }

  MODULE
  {
    name = ModuleKsmProcessController
    id = chemicalProcess
    capacity = 36.0      //  2.0 * 18  (MiniISRU is 18 times bigger than the kerbalism-chemicalplant)
  }
}

@PART[ISRU]:FOR[Kerbalism]
{
  !MODULE[ModuleResourceConverter],* {}
  !MODULE[ModuleOverheatDisplay] {}
  !MODULE[ModuleCoreHeat] {}

  MODULE
  {
    name = ModuleB9PartSwitch
    switcherDescription = #kerbalism-part-chemicalProcess1
    moduleID = chemicalProcess1
    affectDragCubes = false
    affectFARVoxels = false
  }

  MODULE
  {
    name = ModuleB9PartSwitch
    switcherDescription = #kerbalism-part-chemicalProcess2
    moduleID = chemicalProcess2
    affectDragCubes = false
    affectFARVoxels = false
  }

  MODULE
  {
    name = ModuleKsmProcessController
    id = chemicalProcess1
    capacity = 90.0
  }

  MODULE
  {
    name = ModuleKsmProcessController
    id = chemicalProcess2
    capacity = 90.0
  }
}

// add subtypes to all part switches with a moduleID that matches chemical*
// do this AFTER[Kerbalism] so that other support configs can add chemical
// processors to parts without having to re-define this list
@PART[*]:HAS[@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[chemical*]]]:AFTER[Kerbalism]
{
  @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[chemical*]],*
  {
    SUBTYPE
		{
			name = waterElectrolysis
			title = #KERBALISM_WaterElectrolysis_title
			descriptionSummary = #KERBALISM_WaterElectrolysis_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = sabatierProcess
			title = #KERBALISM_SabatierProcess_title
			descriptionSummary = #KERBALISM_SabatierProcess_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = haberProcess
			title = #KERBALISM_HaberProcess_title
			descriptionSummary = #KERBALISM_HaberProcess_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = wasteIncinerator
			title = #KERBALISM_WasteIncinerator_title
			descriptionSummary = #KERBALISM_WasteIncinerator_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = wasteCompressor
			title = #KERBALISM_WasteCompressor_title
			descriptionSummary = #KERBALISM_WasteCompressor_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = anthraquinoneProcess
			title = #KERBALISM_AnthraquinoneProcess_title
			descriptionSummary = #KERBALISM_AnthraquinoneProcess_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = hydrazineProduction
			title = #KERBALISM_HydrazineProduction_title
			descriptionSummary = #KERBALISM_HydrazineProduction_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = hydrazineProductionN2
			title = #KERBALISM_HydrazineProductionN2_title
			descriptionSummary = #KERBALISM_HydrazineProductionN2_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = solidOxideElectrolysis
			title = #KERBALISM_SolidOxideElectrolysis_title
			descriptionSummary = #KERBALISM_SolidOxideElectrolysis_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = moltenRegolithElectrolysis
			title = #KERBALISM_MoltenRegolithElectrolysis_title
			descriptionSummary = #KERBALISM_MoltenRegolithElectrolysis_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
		{
			name = selectiveCatalyticOxidation
			title = #KERBALISM_SelectiveCatalyticOxidation_title
			descriptionSummary = #KERBALISM_SelectiveCatalyticOxidation_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
  }
}

// ============================================================================
// Fuel cells
// ============================================================================

@PART[FuelCell,FuelCellArray]:FOR[Kerbalism]
{
  !MODULE[ModuleResourceConverter] {}
  !RESOURCE[ElectricCharge] {}

  MODULE
  {
    name = ModuleKsmProcessController
    id = fuelCell
    capacity = 1
  }

  MODULE
  {
    name = ModuleB9PartSwitch
    switcherDescription = #autoLOC_502022 // Fuel Cell
    moduleID = fuelCell
    affectDragCubes = false
    affectFARVoxels = false
  }
}

@PART[FuelCellArray]:FOR[Kerbalism]
{
  @MODULE[ModuleKsmProcessController]
  {
    @capacity = 6
  }
}

// add subtypes to all part switches with a moduleID that matches fuelCell*
// do this AFTER[Kerbalism] so that other support configs can add fuel cells
// to parts without having to re-define this list
@PART[*]:HAS[@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelCell*]]]:AFTER[Kerbalism]
{
  @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelCell*]],*
  {
    SUBTYPE
		{
			name = fuelCell
			title = #KERBALISM_H2O2FuelCell_title
			descriptionSummary = #KERBALISM_H2O2FuelCell_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
		}
    SUBTYPE
    {
      name = monopropFuelCell
      title = #KERBALISM_MonopropO2FuelCell_title
      descriptionSummary = #KERBALISM_MonopropO2FuelCell_desc
      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmProcessController
          id = #$../../../moduleID$
        }
        DATA {
          processName = #$../../name$
        }
      }
    }
  }
}
