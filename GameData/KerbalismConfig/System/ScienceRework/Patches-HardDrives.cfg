// ============================================================================
// Remove stock science data containers, add hard-drives/sample containers instead
// Setting default drive sizes for all parts, even modded ones
// modded parts will need separate tweaks in their own configs
// ============================================================================
@PART[*]:HAS[@MODULE[ModuleScienceContainer]]:NEEDS[KerbalismScience]
{
	!MODULE[ModuleScienceContainer] {}
}

@PART[*]:HAS[@MODULE[ModuleCommand]]:NEEDS[KerbalismScience]
{
	MODULE
	{
		name = HardDrive // auto-assign capacity
		title = Probe Core Storage
    sampleCapacity = 0
	}
}

// ============================================================================
// Add the ability to store samples to command pods
// ============================================================================
@PART[*]:HAS[@MODULE[ModuleCommand],#CrewCapacity[>0]]:NEEDS[KerbalismFailures]:FOR[Kerbalism]
{
	@MODULE[HardDrive]
	{
    @title = Command Module Storage
		@sampleCapacity = -2 // -2 = auto-assign capacity
	}
}

// ============================================================================
// Adding HardDrive module for snowflakes so they can get patched.
// ============================================================================
@PART[*]:HAS[@MODULE[ModuleScienceLab],@MODULE[Laboratory]]:NEEDS[KerbalismScience]
{
	MODULE
	{
		name = HardDrive
    title = Laboratory Storage
	}
}

@PART[ScienceBox]:NEEDS[KerbalismScience]
{
	MODULE
	{
		name = HardDrive
    title = Sample Storage
    dataCapacity = 0
    sampleCapacity = 6
	}
}

@PART[kerbalEVA*]:HAS[@MODULE[ModuleTripLogger]]:NEEDS[KerbalismScience]
{
	MODULE
	{
		name = HardDrive
    title = EVA Storage
    dataCapacity = -1
    sampleCapacity = -1
	}
}

// ============================================================================
// Internal(Private) Drive upgrades
// these have to be done by hand to avoid patching groups. (labs mainly)
// ============================================================================
// Goo
@PART[*]:HAS[@MODULE[Experiment]:HAS[#experiment_id[mysteryGoo]],!MODULE[Laboratory]]:NEEDS[KerbalismScience]:FOR[zzzKerbalism]
{
	MODULE
	{
		name = HardDrive
		experiment_id = mysteryGoo
		dataCapacity = 0
		sampleCapacity = #$@KERBALISM_HDD_SIZES/STOCK/PRIVATE_DRIVES/MysteryGoo/samples$

		UPGRADES
		{
			UPGRADE
			{
				name__ = Goo-Storage-Upgrade
				techRequired__ = #$../../../@KERBALISM_HDD_SIZES/STOCK/PRIVATE_DRIVES/MysteryGoo/UpgradeTech$
				sampleCapacity = #$../../#sampleCapacity$
				@sampleCapacity *= #$../../../@KERBALISM_HDD_SIZES/STOCK/PRIVATE_DRIVES/MysteryGoo/SampleReservoirUpgrade$
			}
		}
	}
}

// Materials Bay
@PART[*]:HAS[@MODULE[Experiment]:HAS[#experiment_id[mobileMaterialsLab]],!MODULE[Laboratory]]:NEEDS[KerbalismScience]:FOR[zzzKerbalism]
{
	MODULE
	{
		name = HardDrive
		experiment_id = mobileMaterialsLab
		dataCapacity = 0
		sampleCapacity = #$@KERBALISM_HDD_SIZES/STOCK/PRIVATE_DRIVES/MaterialsBay/samples$

		UPGRADES
		{
			UPGRADE
			{
				name__ = MatBay-Storage-Upgrade
				techRequired__ = #$../../../@KERBALISM_HDD_SIZES/STOCK/PRIVATE_DRIVES/MaterialsBay/UpgradeTech$
				sampleCapacity = #$../../#sampleCapacity$
				@sampleCapacity *= #$../../../@KERBALISM_HDD_SIZES/STOCK/PRIVATE_DRIVES/MaterialsBay/SampleReservoirUpgrade$
			}
		}
	}
}
