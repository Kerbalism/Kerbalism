// remove all the tantares science definitions, replace with our own

// this one isn't used anywhere, plus we have our own - remove it
!EXPERIMENT_DEFINITION:HAS[#id[tantares_telemetry_report]]:NEEDS[Tantares,FeatureScience] {}


// ===========================================
// tantares_radiometer_scan
// setup with same values we use for DMOS
// remove the tantares version if DMOS is present
// ===========================================

@KERBALISM_EXPERIMENT_VALUES:NEEDS[Tantares,FeatureScience]
{
	%Tantares
	{
		radiometer_scan
		{
			size = 7250
			value = 12
			duration = 453600 // 21 days
		}
	}
}
@EXPERIMENT_DEFINITION:HAS[#id[tantares_radiometer_scan]]:NEEDS[Tantares,FeatureScience]:FOR[zzzKerbalismDefault]
{
        @baseValue = #$@KERBALISM_EXPERIMENT_VALUES/Tantares/radiometer_scan/value$
        @dataScale = #$@KERBALISM_EXPERIMENT_VALUES/Tantares/radiometer_scan/size$
        @dataScale /= #$baseValue$
}

@PART[*]:HAS[@MODULE[ModuleScienceExperiment]:HAS[#experimentID[tantares_radiometer_scan]]]:NEEDS[Tantares,FeatureScience]:FOR[KerbalismDefault]
{
	MODULE
	{
		name = Experiment
		experiment_id = tantares_radiometer_scan
		data_rate = #$@KERBALISM_EXPERIMENT_VALUES/Tantares/radiometer_scan/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/Tantares/radiometer_scan/duration$
		ec_rate = 3.2
		allow_shrouded = False
		requires = SunAngleMin:5,SunAngleMax:60
	}

	!MODULE[ModuleScienceExperiment]:HAS[#experimentID[tantares_radiometer_scan]] {}
}


// ===========================================
// replace tantares_radiometer_scan with DMOS version if it is installed
// ===========================================

!EXPERIMENT_DEFINITION:HAS[#id[tantares_radiometer_scan]]:NEEDS[Tantares,FeatureScience,DMagicOrbitalScience] {}
@PART[*]:HAS[@MODULE[Experiment]:HAS[#experiment_id[tantares_radiometer_scan]]]:NEEDS[Tantares,FeatureScience,DMagicOrbitalScience]:FOR[KerbalismDefault]
{
	@MODULE[Experiment]
	{
		@experiment_id = dmRadiometerScan
	}
}

// ===========================================
// tantares_x_ray_scan
// ===========================================

@KERBALISM_EXPERIMENT_VALUES:NEEDS[Tantares,FeatureScience]
{
	%Tantares
	{
		x_ray_scan
		{
			size = 8000
			value = 14
			duration = 453600 // 21 days
		}
	}
}
@EXPERIMENT_DEFINITION:HAS[#id[tantares_x_ray_scan]]:NEEDS[Tantares,FeatureScience]:FOR[zzzKerbalismDefault]
{
        @baseValue = #$@KERBALISM_EXPERIMENT_VALUES/Tantares/x_ray_scan/value$
        @dataScale = #$@KERBALISM_EXPERIMENT_VALUES/Tantares/x_ray_scan/size$
        @dataScale /= #$baseValue$
}

@PART[*]:HAS[@MODULE[ModuleScienceExperiment]:HAS[#experimentID[tantares_x_ray_scan]]]:NEEDS[Tantares,FeatureScience]:FOR[KerbalismDefault]
{
	MODULE
	{
		name = Experiment
		experiment_id = tantares_x_ray_scan
		data_rate = #$@KERBALISM_EXPERIMENT_VALUES/Tantares/x_ray_scan/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/Tantares/x_ray_scan/duration$
		ec_rate = 3.2
		allow_shrouded = False
		requires = SunAngleMin:5,SunAngleMax:60
	}

	!MODULE[ModuleScienceExperiment]:HAS[#experimentID[tantares_x_ray_scan]] {}
}


// ===========================================
// tantares_multispectral_scan
// ===========================================

@KERBALISM_EXPERIMENT_VALUES:NEEDS[Tantares,FeatureScience]
{
	%Tantares
	{
		multispectral_scan
		{
			size = 20000
			value = 20
			duration = 453600 // 21 days
		}
	}
}
@EXPERIMENT_DEFINITION:HAS[#id[tantares_multispectral_scan]]:NEEDS[Tantares,FeatureScience]:FOR[zzzKerbalismDefault]
{
        @baseValue = #$@KERBALISM_EXPERIMENT_VALUES/Tantares/multispectral_scan/value$
        @dataScale = #$@KERBALISM_EXPERIMENT_VALUES/Tantares/multispectral_scan/size$
        @dataScale /= #$baseValue$
}

@PART[*]:HAS[@MODULE[ModuleScienceExperiment]:HAS[#experimentID[tantares_multispectral_scan]]]:NEEDS[Tantares,FeatureScience]:FOR[KerbalismDefault]
{
	MODULE
	{
		name = Experiment
		experiment_id = tantares_multispectral_scan
		data_rate = #$@KERBALISM_EXPERIMENT_VALUES/Tantares/multispectral_scan/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/Tantares/multispectral_scan/duration$
		ec_rate = 1.4
		allow_shrouded = False
	}

	!MODULE[ModuleScienceExperiment]:HAS[#experimentID[tantares_multispectral_scan]] {}
}

// Improving the automatic generated config for Tantares Progress M and Soyus TM/MS to allow more realistic mission times and resupply missions.

@PART[hamal_orbital_module_s1_1]:NEEDS[Tantares,ProfileDefault]:BEFORE[KerbalismDefault]
{
	!CrewCapacity = 1
}

@PART[hamal_orbital_module_s1_1]:NEEDS[Tantares,ProfileDefault]:AFTER[KerbalismDefault]
{
	!MODULE[Configure] {}

	RESOURCE
	{
		name = Oxygen
		amount = 35461
		maxAmount = 35461
	}
	RESOURCE
	{
		name = Nitrogen
		amount = 0
		maxAmount = 39968
	}
	RESOURCE
	{
		name = Food
		amount = 1943
		maxAmount = 1943
	}
	RESOURCE
	{
		name = Waste
		amount = 0
		maxAmount = 2133
	}
}

@PART[hamal_avionics_s1_1]:NEEDS[Tantares,ProfileDefault]:AFTER[KerbalismDefault]
{
	!MODULE[Configure] {}
	!RESOURCE[LiquidFuel] {}
	!RESOURCE[Oxidizer] {}

	RESOURCE
	{
		name = Water
		amount = 420
		maxAmount = 420
	}
	RESOURCE
	{
		name = WasteWater
		amount = 0
		maxAmount = 398
	}
	RESOURCE
	{
		name = LiquidFuel
		amount = 99
		maxAmount = 99
	}
	RESOURCE
	{
		name = Oxidizer
		amount = 121
		maxAmount = 121
	}
}


@PART[tantares_orbital_module_s1_3]:NEEDS[Tantares,ProfileDefault]:AFTER[KerbalismDefault]
{
	!MODULE[Configure] {}
	!RESOURCE[Water] {}
	!RESOURCE[Food] {}
	!RESOURCE[Oxygen] {}
	!RESOURCE[Nitrogen] {}

	RESOURCE
	{
		name = Water
		amount = 8
		maxAmount = 8
	}
	RESOURCE
	{
		name = Food
		amount = 20
		maxAmount = 20
	}
	RESOURCE
	{
		name = Oxygen
		amount = 2200
		maxAmount = 2200
	}
	RESOURCE
	{
		name = Nitrogen
		amount = 1325
		maxAmount = 1325
	}
	RESOURCE
	{
		name = WasteWater
		amount = 0
		maxAmount = 8
	}
	RESOURCE
	{
		name = Waste
		amount = 0
		maxAmount = 20
	}
}
